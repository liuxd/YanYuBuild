<html lang="en-UK">
    <head>
        <title>煙雨江湖搭配器</title>
        <link rel="stylesheet" href="./main.css">
    </head>
    <body>
        <div id="candidate-room"></div>
        <div id="main-player-room"></div>
        <div id="skill-box"></div>

        <script src="./db.js"></script>
        <script>
            let mainPlayerRoom = document.getElementById('main-player-room');
            let candidateRoom = document.getElementById('candidate-room');
            let skillBox = document.getElementById('skill-box');

            function createDiv(className) {
                let div = document.createElement('div');
                div.className = className;
                return div;
            }

            const allowDrop = function (ev) {
                ev.preventDefault();
            }

            const drag = function (ev) {
                ev.dataTransfer.setData("text", ev.target.id);
            }

            const drop = function (ev) {
                ev.preventDefault();
                let data = ev.dataTransfer.getData("text");
                ev.target.appendChild(document.getElementById(data));
            }

            Array(8).fill().map(() => {
                let playerRoom = createDiv('player-room');

                let playerHeadImg = createDiv('player-head-img');
                playerHeadImg.draggable = true;
                playerHeadImg.ondrop = drop;
                playerHeadImg.ondragover = allowDrop;

                let playSkillAttack = createDiv('player-skill player-skill-attack');
                let playSkillMagic = createDiv('player-skill player-skill-magic');
                let playSkillFly = createDiv('player-skill player-skill-fly');

                playerRoom.appendChild(playerHeadImg);
                playerRoom.appendChild(playSkillAttack);
                playerRoom.appendChild(playSkillMagic);
                playerRoom.appendChild(playSkillFly);

                mainPlayerRoom.appendChild(playerRoom);
            });

            db.hero.forEach(hero => {
                let img = document.createElement('img');
                img.src = 'images/' + hero.name + '.png';
                img.width = 100;
                img.height = 140;
                img.id = hero.name;
                img.draggable = true;
                img.ondragstart = drag;

                candidateRoom.appendChild(img);
            });

            db.skill.forEach(skill => {
                let skillDiv = createDiv('skill');
                skillDiv.textContent = skill.name;
                skillDiv.id = skill.name;
                skillDiv.draggable = true;

                skillBox.appendChild(skillDiv);
            });
        </script>
    </body>
</html>